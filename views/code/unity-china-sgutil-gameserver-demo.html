<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">package</span> com<span style="color: #333333">.</span><span style="color: #0000CC">sg</span><span style="color: #333333">.</span><span style="color: #0000CC">util</span><span style="color: #333333">;</span>

<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.ArrayList</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.Arrays</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.Collections</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.Comparator</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.HashMap</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.Iterator</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.List</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.Map</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.Random</span><span style="color: #333333">;</span>

<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">SGGameServerDemo</span> <span style="color: #008800; font-weight: bold">implements</span> SGGameServerInterface <span style="color: #333333">{</span>

    <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">OrderInfo</span> <span style="color: #333333">{</span>
        String id<span style="color: #333333">;</span>
        String productID<span style="color: #333333">;</span>
        <span style="color: #333399; font-weight: bold">int</span> num<span style="color: #333333">;</span>
        String state<span style="color: #333333">;</span>
        <span style="color: #333399; font-weight: bold">long</span> gtime<span style="color: #333333">;</span>
        <span style="color: #333399; font-weight: bold">long</span> ctime<span style="color: #333333">;</span>
        <span style="color: #333399; font-weight: bold">long</span> dtime<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Treasure</span> <span style="color: #333333">{</span>
        String id<span style="color: #333333">;</span>
        String name<span style="color: #333333">;</span>
        <span style="color: #333399; font-weight: bold">int</span> num<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">private</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Log</span> <span style="color: #333333">{</span>
        String id<span style="color: #333333">;</span>
        <span style="color: #333399; font-weight: bold">int</span> value<span style="color: #333333">;</span>
        String msg<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    HashMap<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> UProduct<span style="color: #333333">&gt;</span> mProductList<span style="color: #333333">;</span>
    HashMap<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> OrderInfo<span style="color: #333333">&gt;</span> mOrderList<span style="color: #333333">;</span>
    HashMap<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> Treasure<span style="color: #333333">&gt;</span> mTreasureList<span style="color: #333333">;</span>
    HashMap<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> Log<span style="color: #333333">&gt;</span> mLogList<span style="color: #333333">;</span>
    <span style="color: #333399; font-weight: bold">boolean</span> initialized<span style="color: #333333">;</span>

    <span style="color: #008800; font-weight: bold">private</span> String <span style="color: #0066BB; font-weight: bold">createID</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
        Random r <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Random<span style="color: #333333">();</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> bs <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">8</span><span style="color: #333333">];</span>
        <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">8</span><span style="color: #333333">;</span> i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
            <span style="color: #333399; font-weight: bold">int</span> n <span style="color: #333333">=</span> r<span style="color: #333333">.</span><span style="color: #0000CC">nextInt</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">16</span><span style="color: #333333">);</span>
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>n <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">10</span><span style="color: #333333">)</span>
                bs<span style="color: #333333">[</span>i<span style="color: #333333">]</span> <span style="color: #333333">=</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">)</span> <span style="color: #333333">(</span><span style="color: #0044DD">&#39;0&#39;</span> <span style="color: #333333">+</span> n<span style="color: #333333">);</span>
            <span style="color: #008800; font-weight: bold">else</span>
                bs<span style="color: #333333">[</span>i<span style="color: #333333">]</span> <span style="color: #333333">=</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">)</span> <span style="color: #333333">(</span><span style="color: #0044DD">&#39;a&#39;</span> <span style="color: #333333">+</span> n<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">String</span><span style="color: #333333">(</span>bs<span style="color: #333333">);</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">private</span> String <span style="color: #0066BB; font-weight: bold">createProductID</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
        String id<span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">do</span> <span style="color: #333333">{</span>
            id <span style="color: #333333">=</span> createID<span style="color: #333333">();</span>
        <span style="color: #333333">}</span> <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>mProductList<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>id<span style="color: #333333">)</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">return</span> id<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">private</span> String <span style="color: #0066BB; font-weight: bold">createOrderID</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
        String id<span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">do</span> <span style="color: #333333">{</span>
            id <span style="color: #333333">=</span> createID<span style="color: #333333">();</span>
        <span style="color: #333333">}</span> <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>mOrderList<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>id<span style="color: #333333">)</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">return</span> id<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">private</span> String <span style="color: #0066BB; font-weight: bold">createTreasureID</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
        String id<span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">do</span> <span style="color: #333333">{</span>
            id <span style="color: #333333">=</span> createID<span style="color: #333333">();</span>
        <span style="color: #333333">}</span> <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>mTreasureList<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>id<span style="color: #333333">)</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">return</span> id<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">private</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">addProduct</span><span style="color: #333333">(</span>String name<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> price<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> coins<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        UProduct p <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> UProduct<span style="color: #333333">();</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setProductID</span><span style="color: #333333">(</span>createProductID<span style="color: #333333">());</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setProductName</span><span style="color: #333333">(</span>name<span style="color: #333333">);</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setProductDesc</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">);</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setRoleID</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">);</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setRoleName</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">);</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setRoleLevel</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">);</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setServerID</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">);</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setServerName</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">);</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setPrice</span><span style="color: #333333">(</span>price<span style="color: #333333">);</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setCoins</span><span style="color: #333333">(</span>coins<span style="color: #333333">);</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setAppID</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">);</span>
        p<span style="color: #333333">.</span><span style="color: #0000CC">setAppName</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;SGUtil&quot;</span><span style="color: #333333">);</span>
        mProductList<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>p<span style="color: #333333">.</span><span style="color: #0000CC">getProductID</span><span style="color: #333333">(),</span> p<span style="color: #333333">);</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">private</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">addTreasure</span><span style="color: #333333">(</span>String name<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> num<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        Treasure t <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Treasure<span style="color: #333333">();</span>
        t<span style="color: #333333">.</span><span style="color: #0000CC">id</span> <span style="color: #333333">=</span> createTreasureID<span style="color: #333333">();</span>
        t<span style="color: #333333">.</span><span style="color: #0000CC">name</span> <span style="color: #333333">=</span> name<span style="color: #333333">;</span>
        t<span style="color: #333333">.</span><span style="color: #0000CC">num</span> <span style="color: #333333">=</span> num<span style="color: #333333">;</span>
        mTreasureList<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>t<span style="color: #333333">.</span><span style="color: #0000CC">id</span><span style="color: #333333">,</span> t<span style="color: #333333">);</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">init</span><span style="color: #333333">(</span>SGAgent agent<span style="color: #333333">,</span> Map<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> String<span style="color: #333333">&gt;</span> params<span style="color: #333333">,</span> String cookie<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(!</span>initialized<span style="color: #333333">)</span> <span style="color: #333333">{</span>
            initialized <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">true</span><span style="color: #333333">;</span>
            mProductList <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HashMap<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> UProduct<span style="color: #333333">&gt;(</span><span style="color: #0000DD; font-weight: bold">8</span><span style="color: #333333">);</span>
            mOrderList <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HashMap<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> OrderInfo<span style="color: #333333">&gt;();</span>
            mTreasureList <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HashMap<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> Treasure<span style="color: #333333">&gt;(</span><span style="color: #0000DD; font-weight: bold">8</span><span style="color: #333333">);</span>
            mLogList <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HashMap<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> Log<span style="color: #333333">&gt;(</span><span style="color: #0000DD; font-weight: bold">64</span><span style="color: #333333">);</span>
            addProduct<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;English 900&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">100</span><span style="color: #333333">);</span>
            addProduct<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;新概念1&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">10</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">1000</span><span style="color: #333333">);</span>
            addProduct<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;新概念2&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">20</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">2000</span><span style="color: #333333">);</span>
            addProduct<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;新概念3&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">30</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">3000</span><span style="color: #333333">);</span>
            addProduct<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;新概念4&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">40</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">4000</span><span style="color: #333333">);</span>
            addProduct<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;新概念5&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">50</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">5000</span><span style="color: #333333">);</span>
            addProduct<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;新概念6&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">60</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">6000</span><span style="color: #333333">);</span>
            addProduct<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;新概念全集&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">150</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">21000</span><span style="color: #333333">);</span>
            addTreasure<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;GoldMedal&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">10</span><span style="color: #333333">);</span>
            addTreasure<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;SilverMedal&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">100</span><span style="color: #333333">);</span>
        <span style="color: #333333">}</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> UAccount <span style="color: #0066BB; font-weight: bold">login</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">UAccount</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;sg_demo&quot;</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;sg_demo&quot;</span><span style="color: #333333">);</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> String <span style="color: #0066BB; font-weight: bold">getPlayerDetails</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> List<span style="color: #333333">&lt;</span>UProduct<span style="color: #333333">&gt;</span> <span style="color: #0066BB; font-weight: bold">getProductList</span><span style="color: #333333">(</span>String filter<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        List<span style="color: #333333">&lt;</span>UProduct<span style="color: #333333">&gt;</span> pl <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> ArrayList<span style="color: #333333">&lt;</span>UProduct<span style="color: #333333">&gt;(</span>mProductList<span style="color: #333333">.</span><span style="color: #0000CC">size</span><span style="color: #333333">());</span>
        Iterator it <span style="color: #333333">=</span> mProductList<span style="color: #333333">.</span><span style="color: #0000CC">entrySet</span><span style="color: #333333">().</span><span style="color: #0000CC">iterator</span><span style="color: #333333">();</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>it<span style="color: #333333">.</span><span style="color: #0000CC">hasNext</span><span style="color: #333333">())</span> <span style="color: #333333">{</span>
            Map<span style="color: #333333">.</span><span style="color: #0000CC">Entry</span><span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> UProduct<span style="color: #333333">&gt;</span> e <span style="color: #333333">=</span> <span style="color: #333333">(</span>Map<span style="color: #333333">.</span><span style="color: #0000CC">Entry</span><span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> UProduct<span style="color: #333333">&gt;)</span>it<span style="color: #333333">.</span><span style="color: #0000CC">next</span><span style="color: #333333">();</span>
            pl<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>e<span style="color: #333333">.</span><span style="color: #0000CC">getValue</span><span style="color: #333333">());</span>
        <span style="color: #333333">}</span>
        Collections<span style="color: #333333">.</span><span style="color: #0000CC">sort</span><span style="color: #333333">(</span>pl<span style="color: #333333">,</span> <span style="color: #008800; font-weight: bold">new</span> Comparator<span style="color: #333333">&lt;</span>UProduct<span style="color: #333333">&gt;()</span> <span style="color: #333333">{</span>
            <span style="color: #555555; font-weight: bold">@Override</span>
            <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">int</span> <span style="color: #0066BB; font-weight: bold">compare</span><span style="color: #333333">(</span>UProduct lhs<span style="color: #333333">,</span> UProduct rhs<span style="color: #333333">)</span> <span style="color: #333333">{</span>
                <span style="color: #333399; font-weight: bold">int</span> d <span style="color: #333333">=</span> lhs<span style="color: #333333">.</span><span style="color: #0000CC">getPrice</span><span style="color: #333333">()</span> <span style="color: #333333">-</span> rhs<span style="color: #333333">.</span><span style="color: #0000CC">getPrice</span><span style="color: #333333">();</span>
                <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>d <span style="color: #333333">==</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">)</span>
                    d <span style="color: #333333">=</span> lhs<span style="color: #333333">.</span><span style="color: #0000CC">getCoins</span><span style="color: #333333">()</span> <span style="color: #333333">-</span> rhs<span style="color: #333333">.</span><span style="color: #0000CC">getCoins</span><span style="color: #333333">();</span>
                <span style="color: #008800; font-weight: bold">return</span> d<span style="color: #333333">;</span>
            <span style="color: #333333">}</span>
        <span style="color: #333333">});</span>
        <span style="color: #008800; font-weight: bold">return</span> pl<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> UOrderTicket <span style="color: #0066BB; font-weight: bold">getOrder</span><span style="color: #333333">(</span>UProduct product<span style="color: #333333">,</span> UPayParams pp<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>pp<span style="color: #333333">.</span><span style="color: #0000CC">getBuyNum</span><span style="color: #333333">()</span> <span style="color: #333333">==</span> <span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            UProduct p <span style="color: #333333">=</span> mProductList<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>product<span style="color: #333333">.</span><span style="color: #0000CC">getProductID</span><span style="color: #333333">());</span>
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>p <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
                OrderInfo oi <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> OrderInfo<span style="color: #333333">();</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">id</span> <span style="color: #333333">=</span> createOrderID<span style="color: #333333">();</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">productID</span> <span style="color: #333333">=</span> product<span style="color: #333333">.</span><span style="color: #0000CC">getProductID</span><span style="color: #333333">();</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">num</span> <span style="color: #333333">=</span> pp<span style="color: #333333">.</span><span style="color: #0000CC">getBuyNum</span><span style="color: #333333">();</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">state</span> <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;generated&quot;</span><span style="color: #333333">;</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">gtime</span> <span style="color: #333333">=</span> System<span style="color: #333333">.</span><span style="color: #0000CC">currentTimeMillis</span><span style="color: #333333">();</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">ctime</span> <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">dtime</span> <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
                mOrderList<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>oi<span style="color: #333333">.</span><span style="color: #0000CC">id</span><span style="color: #333333">,</span> oi<span style="color: #333333">);</span>
                <span style="color: #888888">// Use a dummy URL below, but it does not work. Hence the payment process cannot finish.</span>
                <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">UOrderTicket</span><span style="color: #333333">(</span>oi<span style="color: #333333">.</span><span style="color: #0000CC">id</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;http://127.0.0.1/userver/payment_notify.php&quot;</span><span style="color: #333333">);</span>
            <span style="color: #333333">}</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">notifyOrderAccepted</span><span style="color: #333333">(</span>String orderID<span style="color: #333333">,</span> String productID<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> buyNum<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        OrderInfo oi <span style="color: #333333">=</span> mOrderList<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>orderID<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>oi <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>oi<span style="color: #333333">.</span><span style="color: #0000CC">state</span><span style="color: #333333">.</span><span style="color: #0000CC">equals</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;generated&quot;</span><span style="color: #333333">))</span> <span style="color: #333333">{</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">state</span> <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;succeeded&quot;</span><span style="color: #333333">;</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">ctime</span> <span style="color: #333333">=</span> System<span style="color: #333333">.</span><span style="color: #0000CC">currentTimeMillis</span><span style="color: #333333">();</span>
            <span style="color: #333333">}</span>
        <span style="color: #333333">}</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> String <span style="color: #0066BB; font-weight: bold">getOrderState</span><span style="color: #333333">(</span>String orderID<span style="color: #333333">,</span> String productID<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> buyNum<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        OrderInfo oi <span style="color: #333333">=</span> mOrderList<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>orderID<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>oi <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            <span style="color: #008800; font-weight: bold">return</span> oi<span style="color: #333333">.</span><span style="color: #0000CC">state</span><span style="color: #333333">;</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> String <span style="color: #0066BB; font-weight: bold">deliverOrder</span><span style="color: #333333">(</span>String orderID<span style="color: #333333">,</span> String productID<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> buyNum<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        OrderInfo oi <span style="color: #333333">=</span> mOrderList<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>orderID<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>oi <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>oi<span style="color: #333333">.</span><span style="color: #0000CC">state</span><span style="color: #333333">.</span><span style="color: #0000CC">equals</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;succeeded&quot;</span><span style="color: #333333">))</span> <span style="color: #333333">{</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">state</span> <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;delivered&quot;</span><span style="color: #333333">;</span>
                oi<span style="color: #333333">.</span><span style="color: #0000CC">dtime</span> <span style="color: #333333">=</span> System<span style="color: #333333">.</span><span style="color: #0000CC">currentTimeMillis</span><span style="color: #333333">();</span>
                <span style="color: #008800; font-weight: bold">return</span> <span style="background-color: #fff0f0">&quot;OK&quot;</span><span style="color: #333333">;</span>
            <span style="color: #333333">}</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="background-color: #fff0f0">&quot;BAD&quot;</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> List<span style="color: #333333">&lt;</span>UOrder<span style="color: #333333">&gt;</span> <span style="color: #0066BB; font-weight: bold">getOrderInfoList</span><span style="color: #333333">(</span>String filter<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        List<span style="color: #333333">&lt;</span>UOrder<span style="color: #333333">&gt;</span> ol <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> ArrayList<span style="color: #333333">&lt;</span>UOrder<span style="color: #333333">&gt;(</span>mOrderList<span style="color: #333333">.</span><span style="color: #0000CC">size</span><span style="color: #333333">());</span>
        Iterator it <span style="color: #333333">=</span> mOrderList<span style="color: #333333">.</span><span style="color: #0000CC">entrySet</span><span style="color: #333333">().</span><span style="color: #0000CC">iterator</span><span style="color: #333333">();</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>it<span style="color: #333333">.</span><span style="color: #0000CC">hasNext</span><span style="color: #333333">())</span> <span style="color: #333333">{</span>
            Map<span style="color: #333333">.</span><span style="color: #0000CC">Entry</span><span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> OrderInfo<span style="color: #333333">&gt;</span> e <span style="color: #333333">=</span> <span style="color: #333333">(</span>Map<span style="color: #333333">.</span><span style="color: #0000CC">Entry</span><span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> OrderInfo<span style="color: #333333">&gt;)</span>it<span style="color: #333333">.</span><span style="color: #0000CC">next</span><span style="color: #333333">();</span>
            OrderInfo oi <span style="color: #333333">=</span> e<span style="color: #333333">.</span><span style="color: #0000CC">getValue</span><span style="color: #333333">();</span>
            UProduct p <span style="color: #333333">=</span> mProductList<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>oi<span style="color: #333333">.</span><span style="color: #0000CC">productID</span><span style="color: #333333">);</span>
            UOrder order <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> UOrder<span style="color: #333333">();</span>
            UOrderTicket ticket <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> UOrderTicket<span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">,</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">);</span>
            UPayParams pp <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> UPayParams<span style="color: #333333">();</span>
            order<span style="color: #333333">.</span><span style="color: #0000CC">setPayParams</span><span style="color: #333333">(</span>pp<span style="color: #333333">);</span>
            order<span style="color: #333333">.</span><span style="color: #0000CC">setOrderTicket</span><span style="color: #333333">(</span>ticket<span style="color: #333333">);</span>
            order<span style="color: #333333">.</span><span style="color: #0000CC">setState</span><span style="color: #333333">(</span>oi<span style="color: #333333">.</span><span style="color: #0000CC">state</span><span style="color: #333333">);</span>
            order<span style="color: #333333">.</span><span style="color: #0000CC">setGeneratedTime</span><span style="color: #333333">(</span>oi<span style="color: #333333">.</span><span style="color: #0000CC">gtime</span><span style="color: #333333">);</span>
            order<span style="color: #333333">.</span><span style="color: #0000CC">setCompletedTime</span><span style="color: #333333">(</span>oi<span style="color: #333333">.</span><span style="color: #0000CC">ctime</span><span style="color: #333333">);</span>
            order<span style="color: #333333">.</span><span style="color: #0000CC">setDeliveredTime</span><span style="color: #333333">(</span>oi<span style="color: #333333">.</span><span style="color: #0000CC">dtime</span><span style="color: #333333">);</span>
            ticket<span style="color: #333333">.</span><span style="color: #0000CC">setOrderID</span><span style="color: #333333">(</span>e<span style="color: #333333">.</span><span style="color: #0000CC">getKey</span><span style="color: #333333">());</span>
            ticket<span style="color: #333333">.</span><span style="color: #0000CC">setExtension</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">);</span>
            pp<span style="color: #333333">.</span><span style="color: #0000CC">setProductID</span><span style="color: #333333">(</span>p<span style="color: #333333">.</span><span style="color: #0000CC">getProductID</span><span style="color: #333333">());</span>
            pp<span style="color: #333333">.</span><span style="color: #0000CC">setBuyNum</span><span style="color: #333333">(</span>oi<span style="color: #333333">.</span><span style="color: #0000CC">num</span><span style="color: #333333">);</span>
            pp<span style="color: #333333">.</span><span style="color: #0000CC">setRatio</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">);</span>
            pp<span style="color: #333333">.</span><span style="color: #0000CC">setVip</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">);</span>
            ol<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>order<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>
        Collections<span style="color: #333333">.</span><span style="color: #0000CC">sort</span><span style="color: #333333">(</span>ol<span style="color: #333333">,</span> <span style="color: #008800; font-weight: bold">new</span> Comparator<span style="color: #333333">&lt;</span>UOrder<span style="color: #333333">&gt;()</span> <span style="color: #333333">{</span>
            <span style="color: #555555; font-weight: bold">@Override</span>
            <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">int</span> <span style="color: #0066BB; font-weight: bold">compare</span><span style="color: #333333">(</span>UOrder lhs<span style="color: #333333">,</span> UOrder rhs<span style="color: #333333">)</span> <span style="color: #333333">{</span>
                <span style="color: #008800; font-weight: bold">return</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">)(</span>lhs<span style="color: #333333">.</span><span style="color: #0000CC">getGeneratedTime</span><span style="color: #333333">()</span> <span style="color: #333333">-</span> rhs<span style="color: #333333">.</span><span style="color: #0000CC">getGeneratedTime</span><span style="color: #333333">());</span>
            <span style="color: #333333">}</span>
        <span style="color: #333333">});</span>
        <span style="color: #008800; font-weight: bold">return</span> ol<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> String<span style="color: #333333">[]</span> <span style="color: #0066BB; font-weight: bold">getTreasureList</span><span style="color: #333333">(</span>String filter<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        String<span style="color: #333333">[]</span> treasures <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> String<span style="color: #333333">[</span>mTreasureList<span style="color: #333333">.</span><span style="color: #0000CC">size</span><span style="color: #333333">()];</span>
        Iterator it <span style="color: #333333">=</span> mTreasureList<span style="color: #333333">.</span><span style="color: #0000CC">entrySet</span><span style="color: #333333">().</span><span style="color: #0000CC">iterator</span><span style="color: #333333">();</span>
        <span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>it<span style="color: #333333">.</span><span style="color: #0000CC">hasNext</span><span style="color: #333333">())</span> <span style="color: #333333">{</span>
            Map<span style="color: #333333">.</span><span style="color: #0000CC">Entry</span><span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> Treasure<span style="color: #333333">&gt;</span> e <span style="color: #333333">=</span> <span style="color: #333333">(</span>Map<span style="color: #333333">.</span><span style="color: #0000CC">Entry</span><span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> Treasure<span style="color: #333333">&gt;)</span>it<span style="color: #333333">.</span><span style="color: #0000CC">next</span><span style="color: #333333">();</span>
            Treasure t <span style="color: #333333">=</span> e<span style="color: #333333">.</span><span style="color: #0000CC">getValue</span><span style="color: #333333">();</span>
            treasures<span style="color: #333333">[</span>i<span style="color: #333333">]</span> <span style="color: #333333">=</span> t<span style="color: #333333">.</span><span style="color: #0000CC">name</span> <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;=&quot;</span> <span style="color: #333333">+</span> t<span style="color: #333333">.</span><span style="color: #0000CC">num</span><span style="color: #333333">;</span>
            i<span style="color: #333333">++;</span>
        <span style="color: #333333">}</span>
        Arrays<span style="color: #333333">.</span><span style="color: #0000CC">sort</span><span style="color: #333333">(</span>treasures<span style="color: #333333">,</span> <span style="color: #008800; font-weight: bold">new</span> Comparator<span style="color: #333333">&lt;</span>String<span style="color: #333333">&gt;()</span> <span style="color: #333333">{</span>
            <span style="color: #555555; font-weight: bold">@Override</span>
            <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">int</span> <span style="color: #0066BB; font-weight: bold">compare</span><span style="color: #333333">(</span>String o1<span style="color: #333333">,</span> String o2<span style="color: #333333">)</span> <span style="color: #333333">{</span>
                <span style="color: #008800; font-weight: bold">return</span> o1<span style="color: #333333">.</span><span style="color: #0000CC">substring</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">,</span> o1<span style="color: #333333">.</span><span style="color: #0000CC">indexOf</span><span style="color: #333333">(</span><span style="color: #0044DD">&#39;=&#39;</span><span style="color: #333333">)).</span><span style="color: #0000CC">compareTo</span><span style="color: #333333">(</span>o2<span style="color: #333333">.</span><span style="color: #0000CC">substring</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">,</span> o1<span style="color: #333333">.</span><span style="color: #0000CC">indexOf</span><span style="color: #333333">(</span><span style="color: #0044DD">&#39;=&#39;</span><span style="color: #333333">)));</span>
            <span style="color: #333333">}</span>
        <span style="color: #333333">});</span>
        <span style="color: #008800; font-weight: bold">return</span> treasures<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">int</span> <span style="color: #0066BB; font-weight: bold">incTreasure</span><span style="color: #333333">(</span>String name<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> value<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        Iterator it <span style="color: #333333">=</span> mTreasureList<span style="color: #333333">.</span><span style="color: #0000CC">entrySet</span><span style="color: #333333">().</span><span style="color: #0000CC">iterator</span><span style="color: #333333">();</span>
        <span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>it<span style="color: #333333">.</span><span style="color: #0000CC">hasNext</span><span style="color: #333333">())</span> <span style="color: #333333">{</span>
            Map<span style="color: #333333">.</span><span style="color: #0000CC">Entry</span><span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> Treasure<span style="color: #333333">&gt;</span> e <span style="color: #333333">=</span> <span style="color: #333333">(</span>Map<span style="color: #333333">.</span><span style="color: #0000CC">Entry</span><span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span> Treasure<span style="color: #333333">&gt;)</span>it<span style="color: #333333">.</span><span style="color: #0000CC">next</span><span style="color: #333333">();</span>
            Treasure t <span style="color: #333333">=</span> e<span style="color: #333333">.</span><span style="color: #0000CC">getValue</span><span style="color: #333333">();</span>
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>t<span style="color: #333333">.</span><span style="color: #0000CC">name</span><span style="color: #333333">.</span><span style="color: #0000CC">equals</span><span style="color: #333333">(</span>name<span style="color: #333333">))</span> <span style="color: #333333">{</span>
                t<span style="color: #333333">.</span><span style="color: #0000CC">num</span> <span style="color: #333333">+=</span> value<span style="color: #333333">;</span>
                <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>t<span style="color: #333333">.</span><span style="color: #0000CC">num</span> <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">)</span>
                    t<span style="color: #333333">.</span><span style="color: #0000CC">num</span> <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
                <span style="color: #008800; font-weight: bold">return</span> t<span style="color: #333333">.</span><span style="color: #0000CC">num</span><span style="color: #333333">;</span>
            <span style="color: #333333">}</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> String <span style="color: #0066BB; font-weight: bold">logout</span><span style="color: #333333">(</span>UAccount account<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="background-color: #fff0f0">&quot;OK&quot;</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">boolean</span> <span style="color: #0066BB; font-weight: bold">startGame</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">true</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">boolean</span> <span style="color: #0066BB; font-weight: bold">stopGame</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">true</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">boolean</span> <span style="color: #0066BB; font-weight: bold">log</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">char</span> action<span style="color: #333333">,</span> String key<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> value<span style="color: #333333">,</span> String message<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">boolean</span> waitForResp<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        <span style="color: #008800; font-weight: bold">switch</span> <span style="color: #333333">(</span>action<span style="color: #333333">)</span> <span style="color: #333333">{</span>
            <span style="color: #008800; font-weight: bold">case</span> <span style="color: #997700; font-weight: bold">SGGAMESERVER_LOG_ACTION_LOGIN:</span>
            <span style="color: #008800; font-weight: bold">case</span> <span style="color: #997700; font-weight: bold">SGGAMESERVER_LOG_ACTION_LOGOUT:</span>
            <span style="color: #008800; font-weight: bold">case</span> <span style="color: #997700; font-weight: bold">SGGAMESERVER_LOG_ACTION_STARTGAME:</span>
            <span style="color: #008800; font-weight: bold">case</span> <span style="color: #997700; font-weight: bold">SGGAMESERVER_LOG_ACTION_STOPGAME:</span>
                <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">true</span><span style="color: #333333">;</span>
            <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span>
                <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>key <span style="color: #333333">==</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span>
                    <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">false</span><span style="color: #333333">;</span>
                <span style="color: #333399; font-weight: bold">boolean</span> newLog <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">false</span><span style="color: #333333">;</span>
                Log log <span style="color: #333333">=</span> mLogList<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>key<span style="color: #333333">);</span>
                <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>log <span style="color: #333333">==</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
                    log <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Log<span style="color: #333333">();</span>
                    log<span style="color: #333333">.</span><span style="color: #0000CC">id</span> <span style="color: #333333">=</span> key<span style="color: #333333">;</span>
                    log<span style="color: #333333">.</span><span style="color: #0000CC">msg</span> <span style="color: #333333">=</span> message<span style="color: #333333">;</span>
                    log<span style="color: #333333">.</span><span style="color: #0000CC">value</span> <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
                    newLog <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">true</span><span style="color: #333333">;</span>
                <span style="color: #333333">}</span>
                <span style="color: #008800; font-weight: bold">switch</span> <span style="color: #333333">(</span>action<span style="color: #333333">)</span> <span style="color: #333333">{</span>
                    <span style="color: #008800; font-weight: bold">case</span> <span style="color: #997700; font-weight: bold">SGGAMESERVER_LOG_ACTION_INCVALUE:</span>
                        log<span style="color: #333333">.</span><span style="color: #0000CC">value</span> <span style="color: #333333">+=</span> value<span style="color: #333333">;</span>
                        <span style="color: #008800; font-weight: bold">break</span><span style="color: #333333">;</span>
                    <span style="color: #008800; font-weight: bold">case</span> <span style="color: #997700; font-weight: bold">SGGAMESERVER_LOG_ACTION_DECVALUE:</span>
                        log<span style="color: #333333">.</span><span style="color: #0000CC">value</span> <span style="color: #333333">-=</span> value<span style="color: #333333">;</span>
                        <span style="color: #008800; font-weight: bold">break</span><span style="color: #333333">;</span>
                    <span style="color: #008800; font-weight: bold">case</span> <span style="color: #997700; font-weight: bold">SGGAMESERVER_LOG_ACTION_MAXVALUE:</span>
                        log<span style="color: #333333">.</span><span style="color: #0000CC">value</span> <span style="color: #333333">=</span> log<span style="color: #333333">.</span><span style="color: #0000CC">value</span> <span style="color: #333333">&lt;</span> value <span style="color: #333333">?</span> value <span style="color: #333333">:</span> log<span style="color: #333333">.</span><span style="color: #0000CC">value</span><span style="color: #333333">;</span>
                        <span style="color: #008800; font-weight: bold">break</span><span style="color: #333333">;</span>
                    <span style="color: #008800; font-weight: bold">case</span> <span style="color: #997700; font-weight: bold">SGGAMESERVER_LOG_ACTION_MINVALUE:</span>
                        log<span style="color: #333333">.</span><span style="color: #0000CC">value</span> <span style="color: #333333">=</span> log<span style="color: #333333">.</span><span style="color: #0000CC">value</span> <span style="color: #333333">&gt;</span> value <span style="color: #333333">?</span> value <span style="color: #333333">:</span> log<span style="color: #333333">.</span><span style="color: #0000CC">value</span><span style="color: #333333">;</span>
                        <span style="color: #008800; font-weight: bold">break</span><span style="color: #333333">;</span>
                    <span style="color: #008800; font-weight: bold">case</span> <span style="color: #997700; font-weight: bold">SGGAMESERVER_LOG_ACTION_UPDATEVALUE:</span>
                        log<span style="color: #333333">.</span><span style="color: #0000CC">value</span> <span style="color: #333333">=</span> value<span style="color: #333333">;</span>
                        <span style="color: #008800; font-weight: bold">break</span><span style="color: #333333">;</span>
                    <span style="color: #008800; font-weight: bold">default</span><span style="color: #333333">:</span>
                        newLog <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">false</span><span style="color: #333333">;</span>
                <span style="color: #333333">}</span>
                <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>newLog<span style="color: #333333">)</span>
                    mLogList<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>key<span style="color: #333333">,</span> log<span style="color: #333333">);</span>
                <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">true</span><span style="color: #333333">;</span>
        <span style="color: #333333">}</span>
    <span style="color: #333333">}</span>

    <span style="color: #008800; font-weight: bold">public</span> String <span style="color: #0066BB; font-weight: bold">getLogValue</span><span style="color: #333333">(</span>String key<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> defaultValue<span style="color: #333333">)</span> <span style="color: #333333">{</span>
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>key <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            Log log <span style="color: #333333">=</span> mLogList<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>key<span style="color: #333333">);</span>
            <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>log <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span>
                <span style="color: #008800; font-weight: bold">return</span> <span style="background-color: #fff0f0">&quot;&quot;</span> <span style="color: #333333">+</span> log<span style="color: #333333">.</span><span style="color: #0000CC">value</span> <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;,&quot;</span> <span style="color: #333333">+</span> log<span style="color: #333333">.</span><span style="color: #0000CC">msg</span><span style="color: #333333">;</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="background-color: #fff0f0">&quot;&quot;</span> <span style="color: #333333">+</span> defaultValue <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span>

<span style="color: #333333">}</span>
</pre></div>
