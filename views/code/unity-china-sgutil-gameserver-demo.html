<!-- HTML generated using hilite.me --><div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008000; font-weight: bold">package</span> com<span style="color: #666666">.</span><span style="color: #7D9029">sg</span><span style="color: #666666">.</span><span style="color: #7D9029">util</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.ArrayList</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.Arrays</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.Collections</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.Comparator</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.HashMap</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.Iterator</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.List</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.Map</span><span style="color: #666666">;</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">java.util.Random</span><span style="color: #666666">;</span>

<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">SGGameServerDemo</span> <span style="color: #008000; font-weight: bold">implements</span> SGGameServerInterface <span style="color: #666666">{</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">OrderInfo</span> <span style="color: #666666">{</span>
        String id<span style="color: #666666">;</span>
        String productID<span style="color: #666666">;</span>
        <span style="color: #B00040">int</span> num<span style="color: #666666">;</span>
        String state<span style="color: #666666">;</span>
        <span style="color: #B00040">long</span> gtime<span style="color: #666666">;</span>
        <span style="color: #B00040">long</span> ctime<span style="color: #666666">;</span>
        <span style="color: #B00040">long</span> dtime<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Treasure</span> <span style="color: #666666">{</span>
        String id<span style="color: #666666">;</span>
        String name<span style="color: #666666">;</span>
        <span style="color: #B00040">int</span> num<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Log</span> <span style="color: #666666">{</span>
        String id<span style="color: #666666">;</span>
        <span style="color: #B00040">int</span> value<span style="color: #666666">;</span>
        String msg<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    HashMap<span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> UProduct<span style="color: #666666">&gt;</span> mProductList<span style="color: #666666">;</span>
    HashMap<span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> OrderInfo<span style="color: #666666">&gt;</span> mOrderList<span style="color: #666666">;</span>
    HashMap<span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> Treasure<span style="color: #666666">&gt;</span> mTreasureList<span style="color: #666666">;</span>
    HashMap<span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> Log<span style="color: #666666">&gt;</span> mLogList<span style="color: #666666">;</span>
    <span style="color: #B00040">boolean</span> initialized<span style="color: #666666">;</span>

    <span style="color: #008000; font-weight: bold">private</span> String <span style="color: #0000FF">createID</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        Random r <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> Random<span style="color: #666666">();</span>
        <span style="color: #B00040">byte</span><span style="color: #666666">[]</span> bs <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">byte</span><span style="color: #666666">[8];</span>
        <span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">(</span><span style="color: #B00040">int</span> i <span style="color: #666666">=</span> <span style="color: #666666">0;</span> i <span style="color: #666666">&lt;</span> <span style="color: #666666">8;</span> i<span style="color: #666666">++)</span> <span style="color: #666666">{</span>
            <span style="color: #B00040">int</span> n <span style="color: #666666">=</span> r<span style="color: #666666">.</span><span style="color: #7D9029">nextInt</span><span style="color: #666666">(16);</span>
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>n <span style="color: #666666">&lt;</span> <span style="color: #666666">10)</span>
                bs<span style="color: #666666">[</span>i<span style="color: #666666">]</span> <span style="color: #666666">=</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span><span style="color: #666666">)</span> <span style="color: #666666">(</span><span style="color: #BA2121">&#39;0&#39;</span> <span style="color: #666666">+</span> n<span style="color: #666666">);</span>
            <span style="color: #008000; font-weight: bold">else</span>
                bs<span style="color: #666666">[</span>i<span style="color: #666666">]</span> <span style="color: #666666">=</span> <span style="color: #666666">(</span><span style="color: #B00040">byte</span><span style="color: #666666">)</span> <span style="color: #666666">(</span><span style="color: #BA2121">&#39;a&#39;</span> <span style="color: #666666">+</span> n<span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #0000FF">String</span><span style="color: #666666">(</span>bs<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> String <span style="color: #0000FF">createProductID</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        String id<span style="color: #666666">;</span>
        <span style="color: #008000; font-weight: bold">do</span> <span style="color: #666666">{</span>
            id <span style="color: #666666">=</span> createID<span style="color: #666666">();</span>
        <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">while</span> <span style="color: #666666">(</span>mProductList<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>id<span style="color: #666666">)</span> <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">return</span> id<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> String <span style="color: #0000FF">createOrderID</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        String id<span style="color: #666666">;</span>
        <span style="color: #008000; font-weight: bold">do</span> <span style="color: #666666">{</span>
            id <span style="color: #666666">=</span> createID<span style="color: #666666">();</span>
        <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">while</span> <span style="color: #666666">(</span>mOrderList<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>id<span style="color: #666666">)</span> <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">return</span> id<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> String <span style="color: #0000FF">createTreasureID</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        String id<span style="color: #666666">;</span>
        <span style="color: #008000; font-weight: bold">do</span> <span style="color: #666666">{</span>
            id <span style="color: #666666">=</span> createID<span style="color: #666666">();</span>
        <span style="color: #666666">}</span> <span style="color: #008000; font-weight: bold">while</span> <span style="color: #666666">(</span>mTreasureList<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>id<span style="color: #666666">)</span> <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">return</span> id<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">addProduct</span><span style="color: #666666">(</span>String name<span style="color: #666666">,</span> <span style="color: #B00040">int</span> price<span style="color: #666666">,</span> <span style="color: #B00040">int</span> coins<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        UProduct p <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> UProduct<span style="color: #666666">();</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setProductID</span><span style="color: #666666">(</span>createProductID<span style="color: #666666">());</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setProductName</span><span style="color: #666666">(</span>name<span style="color: #666666">);</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setProductDesc</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">);</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setRoleID</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">);</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setRoleName</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">);</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setRoleLevel</span><span style="color: #666666">(0);</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setServerID</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">);</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setServerName</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">);</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setPrice</span><span style="color: #666666">(</span>price<span style="color: #666666">);</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setCoins</span><span style="color: #666666">(</span>coins<span style="color: #666666">);</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setAppID</span><span style="color: #666666">(4);</span>
        p<span style="color: #666666">.</span><span style="color: #7D9029">setAppName</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;SGUtil&quot;</span><span style="color: #666666">);</span>
        mProductList<span style="color: #666666">.</span><span style="color: #7D9029">put</span><span style="color: #666666">(</span>p<span style="color: #666666">.</span><span style="color: #7D9029">getProductID</span><span style="color: #666666">(),</span> p<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">private</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">addTreasure</span><span style="color: #666666">(</span>String name<span style="color: #666666">,</span> <span style="color: #B00040">int</span> num<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        Treasure t <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> Treasure<span style="color: #666666">();</span>
        t<span style="color: #666666">.</span><span style="color: #7D9029">id</span> <span style="color: #666666">=</span> createTreasureID<span style="color: #666666">();</span>
        t<span style="color: #666666">.</span><span style="color: #7D9029">name</span> <span style="color: #666666">=</span> name<span style="color: #666666">;</span>
        t<span style="color: #666666">.</span><span style="color: #7D9029">num</span> <span style="color: #666666">=</span> num<span style="color: #666666">;</span>
        mTreasureList<span style="color: #666666">.</span><span style="color: #7D9029">put</span><span style="color: #666666">(</span>t<span style="color: #666666">.</span><span style="color: #7D9029">id</span><span style="color: #666666">,</span> t<span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">init</span><span style="color: #666666">(</span>SGAgent agent<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(!</span>initialized<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            initialized <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">;</span>
            mProductList <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> HashMap<span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> UProduct<span style="color: #666666">&gt;(8);</span>
            mOrderList <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> HashMap<span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> OrderInfo<span style="color: #666666">&gt;();</span>
            mTreasureList <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> HashMap<span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> Treasure<span style="color: #666666">&gt;(8);</span>
            mLogList <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> HashMap<span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> Log<span style="color: #666666">&gt;(64);</span>
            addProduct<span style="color: #666666">(</span><span style="color: #BA2121">&quot;English 900&quot;</span><span style="color: #666666">,</span> <span style="color: #666666">1,</span> <span style="color: #666666">100);</span>
            addProduct<span style="color: #666666">(</span><span style="color: #BA2121">&quot;新概念1&quot;</span><span style="color: #666666">,</span> <span style="color: #666666">10,</span> <span style="color: #666666">1000);</span>
            addProduct<span style="color: #666666">(</span><span style="color: #BA2121">&quot;新概念2&quot;</span><span style="color: #666666">,</span> <span style="color: #666666">20,</span> <span style="color: #666666">2000);</span>
            addProduct<span style="color: #666666">(</span><span style="color: #BA2121">&quot;新概念3&quot;</span><span style="color: #666666">,</span> <span style="color: #666666">30,</span> <span style="color: #666666">3000);</span>
            addProduct<span style="color: #666666">(</span><span style="color: #BA2121">&quot;新概念4&quot;</span><span style="color: #666666">,</span> <span style="color: #666666">40,</span> <span style="color: #666666">4000);</span>
            addProduct<span style="color: #666666">(</span><span style="color: #BA2121">&quot;新概念5&quot;</span><span style="color: #666666">,</span> <span style="color: #666666">50,</span> <span style="color: #666666">5000);</span>
            addProduct<span style="color: #666666">(</span><span style="color: #BA2121">&quot;新概念6&quot;</span><span style="color: #666666">,</span> <span style="color: #666666">60,</span> <span style="color: #666666">6000);</span>
            addProduct<span style="color: #666666">(</span><span style="color: #BA2121">&quot;新概念全集&quot;</span><span style="color: #666666">,</span> <span style="color: #666666">150,</span> <span style="color: #666666">21000);</span>
            addTreasure<span style="color: #666666">(</span><span style="color: #BA2121">&quot;GoldMedal&quot;</span><span style="color: #666666">,</span> <span style="color: #666666">10);</span>
            addTreasure<span style="color: #666666">(</span><span style="color: #BA2121">&quot;SilverMedal&quot;</span><span style="color: #666666">,</span> <span style="color: #666666">100);</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> UAccount <span style="color: #0000FF">login</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #0000FF">UAccount</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;sg_demo&quot;</span><span style="color: #666666">,</span> <span style="color: #BA2121">&quot;sg_demo&quot;</span><span style="color: #666666">);</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> List<span style="color: #666666">&lt;</span>UProduct<span style="color: #666666">&gt;</span> <span style="color: #0000FF">getProductList</span><span style="color: #666666">(</span>String filter<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        List<span style="color: #666666">&lt;</span>UProduct<span style="color: #666666">&gt;</span> pl <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> ArrayList<span style="color: #666666">&lt;</span>UProduct<span style="color: #666666">&gt;(</span>mProductList<span style="color: #666666">.</span><span style="color: #7D9029">size</span><span style="color: #666666">());</span>
        Iterator it <span style="color: #666666">=</span> mProductList<span style="color: #666666">.</span><span style="color: #7D9029">entrySet</span><span style="color: #666666">().</span><span style="color: #7D9029">iterator</span><span style="color: #666666">();</span>
        <span style="color: #008000; font-weight: bold">while</span> <span style="color: #666666">(</span>it<span style="color: #666666">.</span><span style="color: #7D9029">hasNext</span><span style="color: #666666">())</span> <span style="color: #666666">{</span>
            Map<span style="color: #666666">.</span><span style="color: #7D9029">Entry</span><span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> UProduct<span style="color: #666666">&gt;</span> e <span style="color: #666666">=</span> <span style="color: #666666">(</span>Map<span style="color: #666666">.</span><span style="color: #7D9029">Entry</span><span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> UProduct<span style="color: #666666">&gt;)</span>it<span style="color: #666666">.</span><span style="color: #7D9029">next</span><span style="color: #666666">();</span>
            pl<span style="color: #666666">.</span><span style="color: #7D9029">add</span><span style="color: #666666">(</span>e<span style="color: #666666">.</span><span style="color: #7D9029">getValue</span><span style="color: #666666">());</span>
        <span style="color: #666666">}</span>
        Collections<span style="color: #666666">.</span><span style="color: #7D9029">sort</span><span style="color: #666666">(</span>pl<span style="color: #666666">,</span> <span style="color: #008000; font-weight: bold">new</span> Comparator<span style="color: #666666">&lt;</span>UProduct<span style="color: #666666">&gt;()</span> <span style="color: #666666">{</span>
            <span style="color: #AA22FF">@Override</span>
            <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">compare</span><span style="color: #666666">(</span>UProduct lhs<span style="color: #666666">,</span> UProduct rhs<span style="color: #666666">)</span> <span style="color: #666666">{</span>
                <span style="color: #B00040">int</span> d <span style="color: #666666">=</span> lhs<span style="color: #666666">.</span><span style="color: #7D9029">getPrice</span><span style="color: #666666">()</span> <span style="color: #666666">-</span> rhs<span style="color: #666666">.</span><span style="color: #7D9029">getPrice</span><span style="color: #666666">();</span>
                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>d <span style="color: #666666">==</span> <span style="color: #666666">0)</span>
                    d <span style="color: #666666">=</span> lhs<span style="color: #666666">.</span><span style="color: #7D9029">getCoins</span><span style="color: #666666">()</span> <span style="color: #666666">-</span> rhs<span style="color: #666666">.</span><span style="color: #7D9029">getCoins</span><span style="color: #666666">();</span>
                <span style="color: #008000; font-weight: bold">return</span> d<span style="color: #666666">;</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">});</span>
        <span style="color: #008000; font-weight: bold">return</span> pl<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> UOrderTicket <span style="color: #0000FF">getOrder</span><span style="color: #666666">(</span>UProduct product<span style="color: #666666">,</span> UPayParams pp<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>pp<span style="color: #666666">.</span><span style="color: #7D9029">getBuyNum</span><span style="color: #666666">()</span> <span style="color: #666666">==</span> <span style="color: #666666">1)</span> <span style="color: #666666">{</span>
            UProduct p <span style="color: #666666">=</span> mProductList<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>product<span style="color: #666666">.</span><span style="color: #7D9029">getProductID</span><span style="color: #666666">());</span>
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>p <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
                OrderInfo oi <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> OrderInfo<span style="color: #666666">();</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">id</span> <span style="color: #666666">=</span> createOrderID<span style="color: #666666">();</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">productID</span> <span style="color: #666666">=</span> product<span style="color: #666666">.</span><span style="color: #7D9029">getProductID</span><span style="color: #666666">();</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">num</span> <span style="color: #666666">=</span> pp<span style="color: #666666">.</span><span style="color: #7D9029">getBuyNum</span><span style="color: #666666">();</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">state</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;generated&quot;</span><span style="color: #666666">;</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">gtime</span> <span style="color: #666666">=</span> System<span style="color: #666666">.</span><span style="color: #7D9029">currentTimeMillis</span><span style="color: #666666">();</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">ctime</span> <span style="color: #666666">=</span> <span style="color: #666666">0;</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">dtime</span> <span style="color: #666666">=</span> <span style="color: #666666">0;</span>
                mOrderList<span style="color: #666666">.</span><span style="color: #7D9029">put</span><span style="color: #666666">(</span>oi<span style="color: #666666">.</span><span style="color: #7D9029">id</span><span style="color: #666666">,</span> oi<span style="color: #666666">);</span>
                <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #0000FF">UOrderTicket</span><span style="color: #666666">(</span>oi<span style="color: #666666">.</span><span style="color: #7D9029">id</span><span style="color: #666666">,</span> <span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">);</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">notifyOrderAccepted</span><span style="color: #666666">(</span>String orderID<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        OrderInfo oi <span style="color: #666666">=</span> mOrderList<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>orderID<span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>oi <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>oi<span style="color: #666666">.</span><span style="color: #7D9029">state</span><span style="color: #666666">.</span><span style="color: #7D9029">equals</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;generated&quot;</span><span style="color: #666666">))</span> <span style="color: #666666">{</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">state</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;succeeded&quot;</span><span style="color: #666666">;</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">ctime</span> <span style="color: #666666">=</span> System<span style="color: #666666">.</span><span style="color: #7D9029">currentTimeMillis</span><span style="color: #666666">();</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> String <span style="color: #0000FF">getOrderState</span><span style="color: #666666">(</span>String orderID<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        OrderInfo oi <span style="color: #666666">=</span> mOrderList<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>orderID<span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>oi <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">return</span> oi<span style="color: #666666">.</span><span style="color: #7D9029">state</span><span style="color: #666666">;</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> String <span style="color: #0000FF">deliverOrder</span><span style="color: #666666">(</span>String orderID<span style="color: #666666">,</span> String treasure<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        OrderInfo oi <span style="color: #666666">=</span> mOrderList<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>orderID<span style="color: #666666">);</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>oi <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>oi<span style="color: #666666">.</span><span style="color: #7D9029">state</span><span style="color: #666666">.</span><span style="color: #7D9029">equals</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;succeeded&quot;</span><span style="color: #666666">))</span> <span style="color: #666666">{</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">state</span> <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;delivered&quot;</span><span style="color: #666666">;</span>
                oi<span style="color: #666666">.</span><span style="color: #7D9029">dtime</span> <span style="color: #666666">=</span> System<span style="color: #666666">.</span><span style="color: #7D9029">currentTimeMillis</span><span style="color: #666666">();</span>
                <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;OK&quot;</span><span style="color: #666666">;</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;BAD&quot;</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> List<span style="color: #666666">&lt;</span>UOrder<span style="color: #666666">&gt;</span> <span style="color: #0000FF">getOrderInfoList</span><span style="color: #666666">(</span>String filter<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        List<span style="color: #666666">&lt;</span>UOrder<span style="color: #666666">&gt;</span> ol <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> ArrayList<span style="color: #666666">&lt;</span>UOrder<span style="color: #666666">&gt;(</span>mOrderList<span style="color: #666666">.</span><span style="color: #7D9029">size</span><span style="color: #666666">());</span>
        Iterator it <span style="color: #666666">=</span> mOrderList<span style="color: #666666">.</span><span style="color: #7D9029">entrySet</span><span style="color: #666666">().</span><span style="color: #7D9029">iterator</span><span style="color: #666666">();</span>
        <span style="color: #008000; font-weight: bold">while</span> <span style="color: #666666">(</span>it<span style="color: #666666">.</span><span style="color: #7D9029">hasNext</span><span style="color: #666666">())</span> <span style="color: #666666">{</span>
            Map<span style="color: #666666">.</span><span style="color: #7D9029">Entry</span><span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> OrderInfo<span style="color: #666666">&gt;</span> e <span style="color: #666666">=</span> <span style="color: #666666">(</span>Map<span style="color: #666666">.</span><span style="color: #7D9029">Entry</span><span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> OrderInfo<span style="color: #666666">&gt;)</span>it<span style="color: #666666">.</span><span style="color: #7D9029">next</span><span style="color: #666666">();</span>
            OrderInfo oi <span style="color: #666666">=</span> e<span style="color: #666666">.</span><span style="color: #7D9029">getValue</span><span style="color: #666666">();</span>
            UProduct p <span style="color: #666666">=</span> mProductList<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>oi<span style="color: #666666">.</span><span style="color: #7D9029">productID</span><span style="color: #666666">);</span>
            UOrder order <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> UOrder<span style="color: #666666">();</span>
            UOrderTicket ticket <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> UOrderTicket<span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">,</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">);</span>
            UPayParams pp <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> UPayParams<span style="color: #666666">();</span>
            order<span style="color: #666666">.</span><span style="color: #7D9029">setPayParams</span><span style="color: #666666">(</span>pp<span style="color: #666666">);</span>
            order<span style="color: #666666">.</span><span style="color: #7D9029">setOrderTicket</span><span style="color: #666666">(</span>ticket<span style="color: #666666">);</span>
            order<span style="color: #666666">.</span><span style="color: #7D9029">setState</span><span style="color: #666666">(</span>oi<span style="color: #666666">.</span><span style="color: #7D9029">state</span><span style="color: #666666">);</span>
            order<span style="color: #666666">.</span><span style="color: #7D9029">setGeneratedTime</span><span style="color: #666666">(</span>oi<span style="color: #666666">.</span><span style="color: #7D9029">gtime</span><span style="color: #666666">);</span>
            order<span style="color: #666666">.</span><span style="color: #7D9029">setCompletedTime</span><span style="color: #666666">(</span>oi<span style="color: #666666">.</span><span style="color: #7D9029">ctime</span><span style="color: #666666">);</span>
            order<span style="color: #666666">.</span><span style="color: #7D9029">setDeliveredTime</span><span style="color: #666666">(</span>oi<span style="color: #666666">.</span><span style="color: #7D9029">dtime</span><span style="color: #666666">);</span>
            ticket<span style="color: #666666">.</span><span style="color: #7D9029">setOrderID</span><span style="color: #666666">(</span>e<span style="color: #666666">.</span><span style="color: #7D9029">getKey</span><span style="color: #666666">());</span>
            ticket<span style="color: #666666">.</span><span style="color: #7D9029">setExtension</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">);</span>
            pp<span style="color: #666666">.</span><span style="color: #7D9029">setProductID</span><span style="color: #666666">(</span>p<span style="color: #666666">.</span><span style="color: #7D9029">getProductID</span><span style="color: #666666">());</span>
            pp<span style="color: #666666">.</span><span style="color: #7D9029">setBuyNum</span><span style="color: #666666">(</span>oi<span style="color: #666666">.</span><span style="color: #7D9029">num</span><span style="color: #666666">);</span>
            pp<span style="color: #666666">.</span><span style="color: #7D9029">setRatio</span><span style="color: #666666">(1);</span>
            pp<span style="color: #666666">.</span><span style="color: #7D9029">setVip</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;&quot;</span><span style="color: #666666">);</span>
            ol<span style="color: #666666">.</span><span style="color: #7D9029">add</span><span style="color: #666666">(</span>order<span style="color: #666666">);</span>
        <span style="color: #666666">}</span>
        Collections<span style="color: #666666">.</span><span style="color: #7D9029">sort</span><span style="color: #666666">(</span>ol<span style="color: #666666">,</span> <span style="color: #008000; font-weight: bold">new</span> Comparator<span style="color: #666666">&lt;</span>UOrder<span style="color: #666666">&gt;()</span> <span style="color: #666666">{</span>
            <span style="color: #AA22FF">@Override</span>
            <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">compare</span><span style="color: #666666">(</span>UOrder lhs<span style="color: #666666">,</span> UOrder rhs<span style="color: #666666">)</span> <span style="color: #666666">{</span>
                <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">(</span><span style="color: #B00040">int</span><span style="color: #666666">)(</span>lhs<span style="color: #666666">.</span><span style="color: #7D9029">getGeneratedTime</span><span style="color: #666666">()</span> <span style="color: #666666">-</span> rhs<span style="color: #666666">.</span><span style="color: #7D9029">getGeneratedTime</span><span style="color: #666666">());</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">});</span>
        <span style="color: #008000; font-weight: bold">return</span> ol<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> String<span style="color: #666666">[]</span> <span style="color: #0000FF">getTreasureList</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        String<span style="color: #666666">[]</span> treasures <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> String<span style="color: #666666">[</span>mTreasureList<span style="color: #666666">.</span><span style="color: #7D9029">size</span><span style="color: #666666">()];</span>
        Iterator it <span style="color: #666666">=</span> mTreasureList<span style="color: #666666">.</span><span style="color: #7D9029">entrySet</span><span style="color: #666666">().</span><span style="color: #7D9029">iterator</span><span style="color: #666666">();</span>
        <span style="color: #B00040">int</span> i <span style="color: #666666">=</span> <span style="color: #666666">0;</span>
        <span style="color: #008000; font-weight: bold">while</span> <span style="color: #666666">(</span>it<span style="color: #666666">.</span><span style="color: #7D9029">hasNext</span><span style="color: #666666">())</span> <span style="color: #666666">{</span>
            Map<span style="color: #666666">.</span><span style="color: #7D9029">Entry</span><span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> Treasure<span style="color: #666666">&gt;</span> e <span style="color: #666666">=</span> <span style="color: #666666">(</span>Map<span style="color: #666666">.</span><span style="color: #7D9029">Entry</span><span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> Treasure<span style="color: #666666">&gt;)</span>it<span style="color: #666666">.</span><span style="color: #7D9029">next</span><span style="color: #666666">();</span>
            Treasure t <span style="color: #666666">=</span> e<span style="color: #666666">.</span><span style="color: #7D9029">getValue</span><span style="color: #666666">();</span>
            treasures<span style="color: #666666">[</span>i<span style="color: #666666">]</span> <span style="color: #666666">=</span> t<span style="color: #666666">.</span><span style="color: #7D9029">name</span> <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;=&quot;</span> <span style="color: #666666">+</span> t<span style="color: #666666">.</span><span style="color: #7D9029">num</span><span style="color: #666666">;</span>
            i<span style="color: #666666">++;</span>
        <span style="color: #666666">}</span>
        Arrays<span style="color: #666666">.</span><span style="color: #7D9029">sort</span><span style="color: #666666">(</span>treasures<span style="color: #666666">,</span> <span style="color: #008000; font-weight: bold">new</span> Comparator<span style="color: #666666">&lt;</span>String<span style="color: #666666">&gt;()</span> <span style="color: #666666">{</span>
            <span style="color: #AA22FF">@Override</span>
            <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">compare</span><span style="color: #666666">(</span>String o1<span style="color: #666666">,</span> String o2<span style="color: #666666">)</span> <span style="color: #666666">{</span>
                <span style="color: #008000; font-weight: bold">return</span> o1<span style="color: #666666">.</span><span style="color: #7D9029">substring</span><span style="color: #666666">(0,</span> o1<span style="color: #666666">.</span><span style="color: #7D9029">indexOf</span><span style="color: #666666">(</span><span style="color: #BA2121">&#39;=&#39;</span><span style="color: #666666">)).</span><span style="color: #7D9029">compareTo</span><span style="color: #666666">(</span>o2<span style="color: #666666">.</span><span style="color: #7D9029">substring</span><span style="color: #666666">(0,</span> o1<span style="color: #666666">.</span><span style="color: #7D9029">indexOf</span><span style="color: #666666">(</span><span style="color: #BA2121">&#39;=&#39;</span><span style="color: #666666">)));</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">});</span>
        <span style="color: #008000; font-weight: bold">return</span> treasures<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">incTreasure</span><span style="color: #666666">(</span>String name<span style="color: #666666">,</span> <span style="color: #B00040">int</span> value<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        Iterator it <span style="color: #666666">=</span> mTreasureList<span style="color: #666666">.</span><span style="color: #7D9029">entrySet</span><span style="color: #666666">().</span><span style="color: #7D9029">iterator</span><span style="color: #666666">();</span>
        <span style="color: #B00040">int</span> i <span style="color: #666666">=</span> <span style="color: #666666">0;</span>
        <span style="color: #008000; font-weight: bold">while</span> <span style="color: #666666">(</span>it<span style="color: #666666">.</span><span style="color: #7D9029">hasNext</span><span style="color: #666666">())</span> <span style="color: #666666">{</span>
            Map<span style="color: #666666">.</span><span style="color: #7D9029">Entry</span><span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> Treasure<span style="color: #666666">&gt;</span> e <span style="color: #666666">=</span> <span style="color: #666666">(</span>Map<span style="color: #666666">.</span><span style="color: #7D9029">Entry</span><span style="color: #666666">&lt;</span>String<span style="color: #666666">,</span> Treasure<span style="color: #666666">&gt;)</span>it<span style="color: #666666">.</span><span style="color: #7D9029">next</span><span style="color: #666666">();</span>
            Treasure t <span style="color: #666666">=</span> e<span style="color: #666666">.</span><span style="color: #7D9029">getValue</span><span style="color: #666666">();</span>
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>t<span style="color: #666666">.</span><span style="color: #7D9029">name</span><span style="color: #666666">.</span><span style="color: #7D9029">equals</span><span style="color: #666666">(</span>name<span style="color: #666666">))</span> <span style="color: #666666">{</span>
                t<span style="color: #666666">.</span><span style="color: #7D9029">num</span> <span style="color: #666666">+=</span> value<span style="color: #666666">;</span>
                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>t<span style="color: #666666">.</span><span style="color: #7D9029">num</span> <span style="color: #666666">&lt;</span> <span style="color: #666666">0)</span>
                    t<span style="color: #666666">.</span><span style="color: #7D9029">num</span> <span style="color: #666666">=</span> <span style="color: #666666">0;</span>
                <span style="color: #008000; font-weight: bold">return</span> t<span style="color: #666666">.</span><span style="color: #7D9029">num</span><span style="color: #666666">;</span>
            <span style="color: #666666">}</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">-1;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> String <span style="color: #0000FF">logout</span><span style="color: #666666">(</span>UAccount account<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;OK&quot;</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">boolean</span> <span style="color: #0000FF">startGame</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">boolean</span> <span style="color: #0000FF">stopGame</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">boolean</span> <span style="color: #0000FF">log</span><span style="color: #666666">(</span><span style="color: #B00040">char</span> action<span style="color: #666666">,</span> String key<span style="color: #666666">,</span> <span style="color: #B00040">int</span> value<span style="color: #666666">,</span> String message<span style="color: #666666">,</span> <span style="color: #B00040">boolean</span> waitForResp<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">switch</span> <span style="color: #666666">(</span>action<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            <span style="color: #008000; font-weight: bold">case</span> <span style="color: #A0A000">SGGAMESERVER_LOG_ACTION_LOGIN:</span>
            <span style="color: #008000; font-weight: bold">case</span> <span style="color: #A0A000">SGGAMESERVER_LOG_ACTION_LOGOUT:</span>
            <span style="color: #008000; font-weight: bold">case</span> <span style="color: #A0A000">SGGAMESERVER_LOG_ACTION_STARTGAME:</span>
            <span style="color: #008000; font-weight: bold">case</span> <span style="color: #A0A000">SGGAMESERVER_LOG_ACTION_STOPGAME:</span>
                <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">;</span>
            <span style="color: #008000; font-weight: bold">default</span><span style="color: #666666">:</span>
                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>key <span style="color: #666666">==</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span>
                    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">false</span><span style="color: #666666">;</span>
                <span style="color: #B00040">boolean</span> newLog <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">false</span><span style="color: #666666">;</span>
                Log log <span style="color: #666666">=</span> mLogList<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>key<span style="color: #666666">);</span>
                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>log <span style="color: #666666">==</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
                    log <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> Log<span style="color: #666666">();</span>
                    log<span style="color: #666666">.</span><span style="color: #7D9029">id</span> <span style="color: #666666">=</span> key<span style="color: #666666">;</span>
                    log<span style="color: #666666">.</span><span style="color: #7D9029">msg</span> <span style="color: #666666">=</span> message<span style="color: #666666">;</span>
                    log<span style="color: #666666">.</span><span style="color: #7D9029">value</span> <span style="color: #666666">=</span> <span style="color: #666666">0;</span>
                    newLog <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">;</span>
                <span style="color: #666666">}</span>
                <span style="color: #008000; font-weight: bold">switch</span> <span style="color: #666666">(</span>action<span style="color: #666666">)</span> <span style="color: #666666">{</span>
                    <span style="color: #008000; font-weight: bold">case</span> <span style="color: #A0A000">SGGAMESERVER_LOG_ACTION_INCVALUE:</span>
                        log<span style="color: #666666">.</span><span style="color: #7D9029">value</span> <span style="color: #666666">+=</span> value<span style="color: #666666">;</span>
                        <span style="color: #008000; font-weight: bold">break</span><span style="color: #666666">;</span>
                    <span style="color: #008000; font-weight: bold">case</span> <span style="color: #A0A000">SGGAMESERVER_LOG_ACTION_DECVALUE:</span>
                        log<span style="color: #666666">.</span><span style="color: #7D9029">value</span> <span style="color: #666666">-=</span> value<span style="color: #666666">;</span>
                        <span style="color: #008000; font-weight: bold">break</span><span style="color: #666666">;</span>
                    <span style="color: #008000; font-weight: bold">case</span> <span style="color: #A0A000">SGGAMESERVER_LOG_ACTION_MAXVALUE:</span>
                        log<span style="color: #666666">.</span><span style="color: #7D9029">value</span> <span style="color: #666666">=</span> log<span style="color: #666666">.</span><span style="color: #7D9029">value</span> <span style="color: #666666">&lt;</span> value <span style="color: #666666">?</span> value <span style="color: #666666">:</span> log<span style="color: #666666">.</span><span style="color: #7D9029">value</span><span style="color: #666666">;</span>
                        <span style="color: #008000; font-weight: bold">break</span><span style="color: #666666">;</span>
                    <span style="color: #008000; font-weight: bold">case</span> <span style="color: #A0A000">SGGAMESERVER_LOG_ACTION_MINVALUE:</span>
                        log<span style="color: #666666">.</span><span style="color: #7D9029">value</span> <span style="color: #666666">=</span> log<span style="color: #666666">.</span><span style="color: #7D9029">value</span> <span style="color: #666666">&gt;</span> value <span style="color: #666666">?</span> value <span style="color: #666666">:</span> log<span style="color: #666666">.</span><span style="color: #7D9029">value</span><span style="color: #666666">;</span>
                        <span style="color: #008000; font-weight: bold">break</span><span style="color: #666666">;</span>
                    <span style="color: #008000; font-weight: bold">case</span> <span style="color: #A0A000">SGGAMESERVER_LOG_ACTION_UPDATEVALUE:</span>
                        log<span style="color: #666666">.</span><span style="color: #7D9029">value</span> <span style="color: #666666">=</span> value<span style="color: #666666">;</span>
                        <span style="color: #008000; font-weight: bold">break</span><span style="color: #666666">;</span>
                    <span style="color: #008000; font-weight: bold">default</span><span style="color: #666666">:</span>
                        newLog <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">false</span><span style="color: #666666">;</span>
                <span style="color: #666666">}</span>
                <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>newLog<span style="color: #666666">)</span>
                    mLogList<span style="color: #666666">.</span><span style="color: #7D9029">put</span><span style="color: #666666">(</span>key<span style="color: #666666">,</span> log<span style="color: #666666">);</span>
                <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">;</span>
        <span style="color: #666666">}</span>
    <span style="color: #666666">}</span>

    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">int</span> <span style="color: #0000FF">getLogValue</span><span style="color: #666666">(</span>String key<span style="color: #666666">,</span> <span style="color: #B00040">int</span> defaultValue<span style="color: #666666">)</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>key <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span> <span style="color: #666666">{</span>
            Log log <span style="color: #666666">=</span> mLogList<span style="color: #666666">.</span><span style="color: #7D9029">get</span><span style="color: #666666">(</span>key<span style="color: #666666">);</span>
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>log <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">)</span>
                <span style="color: #008000; font-weight: bold">return</span> log<span style="color: #666666">.</span><span style="color: #7D9029">value</span><span style="color: #666666">;</span>
        <span style="color: #666666">}</span>
        <span style="color: #008000; font-weight: bold">return</span> defaultValue<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

<span style="color: #666666">}</span>
</pre></div>
