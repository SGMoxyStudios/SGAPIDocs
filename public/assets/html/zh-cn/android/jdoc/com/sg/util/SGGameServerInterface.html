<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (1.8.0_121) on Mon Jul 10 19:41:38 CST 2017 -->
<meta http-equiv="Content-Type" content="text/html; charset=utf8">
<title>SGGameServerInterface</title>
<meta name="date" content="2017-07-10">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="SGGameServerInterface";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":6};
var tabs = {65535:["t0","所有方法"],2:["t2","实例方法"],4:["t3","抽象方法"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="跳过导航链接">跳过导航链接</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../com/sg/util/package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../index-all.html">索引</a></li>
<li><a href="../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/sg/util/SGAgent.SGClient.html" title="com.sg.util中的接口"><span class="typeNameLink">上一个类</span></a></li>
<li><a href="../../../com/sg/util/UAccount.html" title="com.sg.util中的类"><span class="typeNameLink">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/sg/util/SGGameServerInterface.html" target="_top">框架</a></li>
<li><a href="SGGameServerInterface.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.sg.util</div>
<h2 title="接口 SGGameServerInterface" class="title">接口 SGGameServerInterface</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public interface <span class="typeNameLabel">SGGameServerInterface</span></pre>
<div class="block"><style type="text/css">
 .comm_flow_table { width:100%;border:1px solid black;border-collapse:collapse }
 .comm_flow_table tr th { border:1px solid black;background-color:#ffc080;padding-left:1em;padding-right:1em }
 .comm_flow_table tr td { border:1px solid black;padding-left:1em;padding-right:1em }
 .comm_flow_table tr th:nth-child(1) { width:5em }
 .comm_flow_table tr th:nth-child(2) { width:17em }
 .comm_flow_table td { word-wrap:break-word; word-break:break-all; }
 .webapi_table { width:100%;border:1px solid black;border-collapse:collapse }
 .webapi_table tr th { border:1px solid black;background-color:#ffc080;padding-left:1em;padding-right:1em }
 .webapi_table tr th:nth-child(1) { width:5em;border-style:none }
 .webapi_table tr th:nth-child(2) { width:5em;border-style:none }
 .webapi_table tr th:nth-child(3) { width:10em;border-style:none }
 .webapi_table tr th:nth-child(4) { width:40em }
 .webapi_table tr th:nth-child(5) { }
 .webapi_table tr td { border:1px solid black;padding-left:1em;padding-right:1em;word-wrap:break-word; word-break:break-all; }
 </style>

 游服接口。
 <p>此接口通过HTTP/HTTPS与游服进行通讯，不可以带UI。它们会被SGAgent的后台线程调用。</p>

 <p>游服是CP提供的管理应用产品和用户订单的服务器，它也可以关联用户、应用等信息，但它必须
 与SG服务器协同工作。</p>

 <p>首先，站在用户的角度来看，登入界面只能有一个。这个登入界面只能由渠道SDK和渠道服务器
 来提供。用户在登录界面上输入账号和密码信息，再按确定开始登入。登入成功后渠道服务器将返
 回会话信息给客户端，而客户端会将信息传给SG服务器，SG服务器再用这个信息到渠道服务器去查
 询看是否真有这次登入。如果查询得到证实，SGGameServerInterface.init将被调用并传入必要的
 会话和应用信息用以初始化接下来的login、pay、logout等操作可能要用到的参数。类似地、游服
 也必须向SG服务器器查询是否有这一次登入，如果查询得到证实则返回成功，这样一个完整的用户
 登入过程就完成了。所以只有渠道服务器管理着用户了解的账户信息，而无论是SG服务器还是游服
 都需要自动生成一个与给定渠道的给定用户关联的用户账户以便管理各种信息。</p>

 <p>其次，渠道服务器管理着在CP在该渠道发布的应用信息。这些信息通常包含应用名称、CP名称、
 应用ID、应用的Key、应用的Secret、支付的Key、支付通知Url等信息。SG服务器需要知道这些信息
 并关联一个自己管理的应用信息，其中包含appID、appKey、appSecret等。游服因为不直接与渠道
 服务器打交道，所以它可以只关心、关联、管理和使用SG服务器生成的应用信息。</p>

 <p>SGGameServerInterface中与SG服务器有关的方法有login、getOrder和getOrderState三个，其他
 方法都由游服独立完成。</p>

 <p>一个成功的登入流程可以分为下面几个步骤。</p>

 <table class="comm_flow_table">
     <tr>
          <th>序号</th>
          <th>操作方</th>
          <th>操作内容</th>
     </tr><tr>
          <td>1</td>
          <td>应用</td>
          <td>用户触发登入流程</td></li>
     </tr><tr>
          <td>2</td>
          <td>应用</td>
          <td>调用SGAgent.login()</li>
     </tr><tr>
          <td>3</td>
          <td>SGAgent</td>
          <td>调起渠道登入画面
     </tr><tr>
          <td>4</td>
          <td>渠道SDK</td>
          <td>用户在登入画面上填写信息并确认登入</td>
     </tr><tr>
          <td>5</td>
          <td>渠道SDK</td>
          <td>向渠道服务器发送登入请求</td>
     </tr><tr>
          <td>6</td>
          <td>渠道服务器</td>
          <td>生成会话，向渠道SDK返回会话信息</td>
     </tr><tr>
          <td>7</td>
          <td>渠道SDK</td>
          <td>接收会话信息并传给SGAgent</td>
     </tr><tr>
          <td>8</td>
          <td>SGAgent</td>
          <td>把信息传给SG服务器做渠道登入验证</td>
     </tr><tr>
          <td>9</td>
          <td>SG服务器</td>
          <td>向渠道服务器做登入验证并返回结果到SGAgent</td>
     </tr><tr>
          <td>10</td>
          <td>SGAgent</td>
          <td>调用SGServerInterface.login()来登入游服</td>
     </tr><tr>
          <td>11</td>
          <td>应用</td>
          <td>在SGServerInterface.login中向游服发送登入请求</td>
     </tr><tr>
          <td>12</td>
          <td>游服</td>
          <td>向SG服务器做登入验证并返回结果到应用</td>
     </tr><tr>
          <td>13</td>
          <td>应用</td>
          <td>登入流程完成，显示后续画面</td>
     </tr>
 </table>

 <p>其中第12步所用到的SG服务器登入验证API的规格如下表所示。</p>

 <table class="webapi_table">
     <tr>
         <th>项目</th>
         <th></th>
         <th></th>
         <th>值</th>
         <th>备注</th>
     </tr><tr>
         <td colspan="3">URL</td>
         <td>https://www.sgstudios.cn:8443/user/verifyAccount</td>
         <td></td>
     </tr><tr>
         <td rowspan="6">请求</td>
     </tr><tr>
         <td colspan="2">方法</td>
         <td>POST</td>
         <td></td>
     </tr><tr>
         <td colspan="2">MIME type</td>
         <td>application/x-www-form-urlencoded</td>
         <td></td>
     </tr><tr>
         <td rowspan="3">参数</td>
         <td>userID</td>
         <td>调用SGGameServerInterface.init时传入的session.getUserID()</td>
         <td></td>
     </tr><tr>
         <td>token</td>
         <td>调用SGGameServerInterface.init时传入的session.getToken()</td>
         <td></td>
     </tr><tr>
         <td>sign</td>
         <td>MD5("userID=" + userID + "token" + token + appKey)</td>
         <td>小写</td>
     </tr><tr>
         <td rowspan="3">应答</td>
     </tr><tr>
         <td colspan="2">MIME type</td>
         <td>text/json</td>
         <td></td>
     </tr><tr>
         <td colspan="2">内容</td>
         <td>{"state":&lt;state&gt;, "data":{"userID":&lt;userID&gt;,"username":&lt;username&gt;,"channelID":&lt;channelID&gt;}}</td>
         <td>尖括号表示各字段的值。其中state取值及含义如下：
         <ul>
             <li>1 - 成功</li>
             <li>6 - 未知用户</li>
             <li>8 - token为空</li>
             <li>9 - 未知会话</li>
             <li>12 - 签名错误</li>
         </ul>
         userID为SG服务器管理的用户ID，username为SG服务器管理的用户名，channelID为SG服务器管理的应用渠道号。
         </td>
     </tr>
 </table>

 <p>一个成功的订单生成流程可以分为下面几个步骤。</p>

 <table class="comm_flow_table">
     <tr>
          <th>序号</th>
          <th>操作方</th>
          <th>操作内容</th>
     </tr><tr>
          <td>1</td>
          <td>应用</td>
          <td>用户触发购买某产品</td></li>
     </tr><tr>
          <td>2</td>
          <td>应用</td>
          <td>调用SGAgent.buyProduct()</li>
     </tr><tr>
          <td>3</td>
          <td>SGAgent</td>
          <td>调用SGGameServerInterface.getOrder()</td>
     </tr><tr>
          <td>4</td>
          <td>应用</td>
          <td>在SGGameServerInterface.getOrder中向游服发出订单生成请求</td>
     </tr><tr>
          <td>5</td>
          <td>游服</td>
          <td>向SG服务器发送订单生成请求</td>
     </tr><tr>
          <td>6</td>
          <td>SG渠道服务器</td>
          <td>生成订单并返回订单号和扩展信息到游服</td>
     </tr><tr>
          <td>7</td>
          <td>游服</td>
          <td>记录订单并返回订单号和扩展信息到应用</td>
     </tr><tr>
          <td>8</td>
          <td>应用</td>
          <td>把订单信息返回给SGAgent</td>
     </tr><tr>
          <td>9</td>
          <td>SGAgent</td>
          <td>调起渠道支付画面</td>
     </tr>
 </table>

 <p>其中第5步所用到的SG服务器订单生成API的规格如下表所示。</p>

 <table class="webapi_table">
     <tr>
         <th>项目</th>
         <th></th>
         <th></th>
         <th>值</th>
         <th>备注</th>
     </tr><tr>
         <td colspan="3">URL</td>
         <td>https://www.sgstudios.cn:8443/pay/getOrderID</td>
         <td></td>
     </tr><tr>
         <td rowspan="16">请求</td>
     </tr><tr>
         <td colspan="2">方法</td>
         <td>POST</td>
         <td></td>
     </tr><tr>
         <td colspan="2">MIME type</td>
         <td>application/x-www-form-urlencoded</td>
         <td></td>
     </tr><tr>
         <td rowspan="13">参数</td>
         <td>userID</td>
         <td>调用SGGameServerInterface.init时传入的session.getUserID()</td>
         <td></td>
     </tr><tr>
         <td>productID</td>
         <td>UPayParams.getProductID()</td>
         <td></td>
     </tr><tr>
         <td>productName</td>
         <td>UPayParams.getProductName()</td>
         <td></td>
     </tr><tr>
         <td>productDesc</td>
         <td>UPayParams.getProductDesc()</td>
         <td></td>
     </tr><tr>
         <td>money</td>
         <td>UPayParams.getPrice() * UPayParams.getBuyNum()</td>
         <td>参见<a href="../../../com/sg/util/UPayParams.html#getPrice--">UPayParams.getPrice</a>和<a href="../../../com/sg/util/UPayParams.html#getBuyNum--">UPayParams.getBuyNum</a>。
         因为购买份数必须为1，所以money等于UPayParams.getPrice()。
         </td>
     </tr><tr>
         <td>roleID</td>
         <td>UPayParams.getRoleID()</td>
         <td></td>
     </tr><tr>
         <td>roleName</td>
         <td>UPayParams.getRoleName()</td>
         <td></td>
     </tr><tr>
         <td>serverID</td>
         <td>UPayParams.getServerID()</td>
         <td></td>
     </tr><tr>
         <td>serverName</td>
         <td>UPayParams.getServerName()</td>
         <td></td>
     </tr><tr>
         <td>extension</td>
         <td>任意字串</td>
         <td>可以结合交易特性传一个有意义的字串，以备将来查询</td>
     </tr><tr>
         <td>notifyUrl</td>
         <td>用于异步接收来自SG服务器支付结果通知的URL</td>
         <td>在支付结果出来后，SG服务器将向此URL以POST方式发送通知。</td>
     </tr><tr>
         <td>signType</td>
         <td>"md5"</td>
         <td></td>
     </tr><tr>
         <td>sign</td>
         <td>MD5("userID=" + userID<br/>
               + "&amp;productID=" + productID
               + "&amp;productName=" + productName
               + "&amp;productDesc=" + productDesc<br/>
               + "&amp;money=" + money<br/>
               + "&amp;roleID=" + roleID
               + "&amp;roleName=" + roleName<br/>
               + "&amp;serverID=" + serverID
               + "&amp;serverName=" + serverName<br/>
               + "&amp;extension=" + extension<br/>
               + "&amp;notifyUrl=" + notifyUrl<br/>
               + appSecret)
         </td>
         <td><ul><li>小写</li><li>appSecret由游服保存，不可放在客户端中</li></ul></td>
     </tr><tr>
         <td rowspan="3">应答</td>
         <td colspan="2">MIME type</td>
         <td>text/json</td>
         <td></td>
     </tr><tr>
         <td colspan="2">内容</td>
         <td>{"state":&lt;state&gt;, "data":{"orderID":&lt;orderID&gt;,"extension":&lt;extension&gt;}}</td>
         <td>尖括号表示各字段的值。其中state取值及含义如下：
         <ul>
             <li>1 - 成功</li>
             <li>6 - 未知用户</li>
             <li>10 - money为负</li>
             <li>11 - 未知渠道</li>
             <li>12 - 签名错误</li>
             <li>13 - 支付已关闭</li>
         </ul>
         orderID为订单号，extension为扩展信息。
         </td>
     </tr>
 </table>

 <p>一个成功的订单状态查询流程可以分为下面几个步骤。</p>

 <table class="comm_flow_table">
     <tr>
          <th>序号</th>
          <th>操作方</th>
          <th>操作内容</th>
     </tr><tr>
          <td>1</td>
          <td>应用</td>
          <td>自动查询或用户触发查询</td></li>
     </tr><tr>
          <td>2</td>
          <td>应用</td>
          <td>调用SGAgent.getProductState()</li>
     </tr><tr>
          <td>3</td>
          <td>SGAgent</td>
          <td>调用SGGameServerInterface.getOrderState()</td>
     </tr><tr>
          <td>4</td>
          <td>应用</td>
          <td>在SGGameServerInterface.getOrderState中向游服发出订单状态查询请求</td>
     </tr><tr>
          <td>5</td>
          <td>游服</td>
          <td>SG服务器会将从渠道服务器获得的订单结果异步（相对于客户端的购买操作）通知给游服。一般情况下通知会很快送达，
          但如果长时间未收到通知则说明支付本身或通知转发上有问题。<br/>
          如果订单已有结果（"succeeded"、"failed"和"cheated"），则直接跳至第7步，返回结果到应用；否则可以向SG服务器发送
          订单状态查询请求并将结果返回到应用。但因为SG服务器收到游服的查询请求后会向渠道服务器查询，所以查询不能频繁地进行，
          每次查询要等待30秒，且最多允许20次有效查询（即间隔足够长并向渠道发起了查询通讯）。<br/>
          如果20次查询后仍无结果则说明支付出现问题或通讯链出现问题，建议人工联系。</td>
     </tr><tr>
          <td>6</td>
          <td>SG渠道服务器</td>
          <td>向渠道服务器发起订单状态查询并返回结果到游服</td>
     </tr><tr>
          <td>7</td>
          <td>游服</td>
          <td>保存订单状态并返回结果到应用</td>
     </tr><tr>
          <td>8</td>
          <td>应用</td>
          <td>显示后续画面</td>
     </tr>
 </table>

 <p>其中第5步所用到的SG服务器订单状态查询API的规格如下表所示。</p>

 <table class="webapi_table">
     <tr>
         <th>项目</th>
         <th></th>
         <th></th>
         <th>值</th>
         <th>备注</th>
     </tr><tr>
         <td colspan="3">URL</td>
         <td>https://www.sgstudios.cn:8443/pay/getOrderState</td>
         <td></td>
     </tr><tr>
         <td rowspan="8">请求</td>
     </tr><tr>
         <td colspan="2">方法</td>
         <td>POST</td>
         <td></td>
     </tr><tr>
         <td colspan="2">MIME type</td>
         <td>application/x-www-form-urlencoded</td>
         <td></td>
     </tr><tr>
         <td rowspan="5">参数</td>
         <td>userID</td>
         <td>调用SGGameServerInterface.init时传入的session.getUserID()</td>
         <td></td>
     </tr><tr>
         <td>queryOrderID</td>
         <td>订单号</td>
         <td></td>
     </tr><tr>
         <td>loginExtension</td>
         <td>调用SGGameServerInterface.init时传入的session.getLoginExtension()</td>
         <td></td>
     </tr><tr>
         <td>signType</td>
         <td>"md5"</td>
         <td></td>
     </tr><tr>
         <td>sign</td>
         <td>MD5("userID=" + userID<br/>
               + "&amp;queryOrderID=" + queryOrderID<br/>
               + "&amp;loginExtention=" + loginExtention
               + appSecret)
         </td>
         <td><ul><li>小写</li><li>appSecret由游服保存，不可放在客户端中</li></ul></td>
     </tr><tr>
         <td rowspan="3">应答</td>
         <td colspan="2">MIME type</td>
         <td>text/json</td>
         <td></td>
     </tr><tr>
         <td colspan="2">内容</td>
         <td>{"state":&lt;state&gt;, "data":{"money":&lt;money&gt;,"realMoney":&lt;realMoney&gt;,"currency":&lt;currency&gt;}}</td>
         <td>尖括号表示各字段的值。其中state取值及含义如下：
         <ul>
             <li>-1 - 查询失败</li>
             <li>1 - 订单已生成</li>
             <li>2 - 支付成功</li>
             <li>3 - 通知游服成功</li>
             <li>4 - 支付失败</li>
         </ul>
         money为订单金额，realMoney为实际支付金额（如果比money少则游服一定不要标记订单为成功或发放产品），curreny为货币种类（"RMB"等）。
         </td>
     </tr>
 </table>

 <p>游服除了要调用SG服务器的功能外，还要实现接收SG服务器的订单状态通知的功能。规格如下如所示。</p>

 <table class="webapi_table">
     <tr>
         <th>项目</th>
         <th></th>
         <th></th>
         <th>值</th>
         <th>备注</th>
     </tr><tr>
         <td colspan="3">URL</td>
         <td>notifyUrl</td>
         <td>生成订单时向SG服务器传送的值</td>
     </tr><tr>
         <td rowspan="17">请求</td>
     </tr><tr>
         <td colspan="2">方法</td>
         <td>POST</td>
         <td></td>
     </tr><tr>
         <td colspan="2">MIME type</td>
         <td>text/json</td>
         <td></td>
     </tr><tr>
         <td rowspan="14">参数</td>
         <td>state</td>
         <td>订单状态</td>
         <td>取值及含义如下：
         <ul>
             <li>1 - 订单已生成</li>
             <li>2 - 支付成功</li>
             <li>3 - 通知游服成功</li>
             <li>4 - 支付失败</li>
         </ul>
         </td>
     </tr><tr>
         <td>data</td>
         <td>订单数据</td>
         <td>data本身是一个json对象，其中包含着订单的各项数据</td>
     </tr><tr>
         <td>channelID</td>
         <td>SG服务器管理的应用渠道号</td>
         <td>data中的项</td>
     </tr><tr>
         <td>currency</td>
         <td>货币种类</td>
         <td>data中的项</td>
     </tr><tr>
         <td>extension</td>
         <td>生成订单时传给SG服务器的任意字串（原样返回）</td>
         <td>data中的项</td>
     </tr><tr>
         <td>gameID</td>
         <td>调用SGGameServerInterface.init时传入的appID</td>
         <td>data中的项</td>
     </tr><tr>
         <td>money</td>
         <td>订单金额</td>
         <td>data中的项</td>
     </tr><tr>
         <td>orderID</td>
         <td>订单号</td>
         <td>data中的项</td>
     </tr><tr>
         <td>productID</td>
         <td>UPayParams.getProductID()</td>
         <td>data中的项</td>
     </tr><tr>
         <td>realMoney</td>
         <td>实际支付金额</td>
         <td>data中的项</td>
     </tr><tr>
         <td>serverID</td>
         <td>UPayParams.getServerID()</td>
         <td>data中的项</td>
     </tr><tr>
         <td>userID</td>
         <td>调用SGGameServerInterface.init时传入的session.getUserID()</td>
         <td>data中的项</td>
     </tr><tr>
         <td>signType</td>
         <td>"md5"</td>
         <td>data中的项</td>
     </tr><tr>
         <td>sign</td>
         <td>MD5("channelID=" + channelID<br/>
               + "&amp;currency=" + currency<br/>
               + "&amp;extension=" + extension<br/>
               + "&amp;gameID=" + gameID<br/>
               + "&amp;money=" + money<br/>
               + "&amp;orderID=" + orderID<br/>
               + "&amp;productID=" + productID<br/>
               + "&amp;realMoney=" + realMoney<br/>
               + "&amp;serverID=" + serverID<br/>
               + "&amp;userID=" + userID<br/>
               + appSecret)
         </td>
         <td>data中的项。<ul><li>小写</li><li>appSecret由游服保存，不可放在客户端中</li></ul></td>
     </tr><tr>
         <td rowspan="3">应答</td>
         <td colspan="2">MIME type</td>
         <td>text/plain</td>
         <td></td>
     </tr><tr>
         <td colspan="2">内容</td>
         <td>处理结果字符串（不带引号）</td>
         <td>字符串及含义如下：
         <ul>
             <li>SUCCESS - 处理成功</li>
             <li>FAIL - 处理失败</li>
         </ul>
         </td>
     </tr>
 </table></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>方法概要</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="方法概要表, 列表方法和解释">
<caption><span id="t0" class="activeTableTab"><span>所有方法</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">实例方法</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">抽象方法</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">方法和说明</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../com/sg/util/UPayParams.html" title="com.sg.util中的类">UPayParams</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/sg/util/SGGameServerInterface.html#createPayParamsFromOrderProduct-com.sg.util.UProduct-">createPayParamsFromOrderProduct</a></span>(<a href="../../../com/sg/util/UProduct.html" title="com.sg.util中的类">UProduct</a>&nbsp;product)</code>
<div class="block">根据指定的产品信息创建支付信息。</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/sg/util/SGGameServerInterface.html#deliverOrder-java.lang.String-">deliverOrder</a></span>(java.lang.String&nbsp;orderID)</code>
<div class="block">通知游服将指定订单标记为已发货。</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../com/sg/util/UOrder.html" title="com.sg.util中的类">UOrder</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/sg/util/SGGameServerInterface.html#getOrder-com.sg.util.UPayParams-">getOrder</a></span>(<a href="../../../com/sg/util/UPayParams.html" title="com.sg.util中的类">UPayParams</a>&nbsp;data)</code>
<div class="block">根据支付信息向游服请求生成订单。</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../com/sg/util/UOrderInfo.html" title="com.sg.util中的类">UOrderInfo</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/sg/util/SGGameServerInterface.html#getOrderInfoList-java.lang.String-">getOrderInfoList</a></span>(java.lang.String&nbsp;filter)</code>
<div class="block">获取用户的订单列表。</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/sg/util/SGGameServerInterface.html#getOrderState-java.lang.String-">getOrderState</a></span>(java.lang.String&nbsp;orderID)</code>
<div class="block">向游服查询订单的状态。</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../com/sg/util/UProduct.html" title="com.sg.util中的类">UProduct</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/sg/util/SGGameServerInterface.html#getProductList-java.lang.String-">getProductList</a></span>(java.lang.String&nbsp;filter)</code>
<div class="block">获取应用的产品（道具）列表。</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/sg/util/SGGameServerInterface.html#init-com.sg.util.USession-int-java.lang.String-">init</a></span>(<a href="../../../com/sg/util/USession.html" title="com.sg.util中的类">USession</a>&nbsp;session,
    int&nbsp;appID,
    java.lang.String&nbsp;appKey)</code>
<div class="block">初始化游服。</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code><a href="../../../com/sg/util/UAccount.html" title="com.sg.util中的类">UAccount</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/sg/util/SGGameServerInterface.html#login--">login</a></span>()</code>
<div class="block">登入游服。</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/sg/util/SGGameServerInterface.html#logout-com.sg.util.UAccount-">logout</a></span>(<a href="../../../com/sg/util/UAccount.html" title="com.sg.util中的类">UAccount</a>&nbsp;account)</code>
<div class="block">登出游服。</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../com/sg/util/SGGameServerInterface.html#notifyOrderAccepted-java.lang.String-">notifyOrderAccepted</a></span>(java.lang.String&nbsp;orderID)</code>
<div class="block">通知游服订单已经被受理。</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>方法详细资料</h3>
<a name="createPayParamsFromOrderProduct-com.sg.util.UProduct-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createPayParamsFromOrderProduct</h4>
<pre><a href="../../../com/sg/util/UPayParams.html" title="com.sg.util中的类">UPayParams</a>&nbsp;createPayParamsFromOrderProduct(<a href="../../../com/sg/util/UProduct.html" title="com.sg.util中的类">UProduct</a>&nbsp;product)</pre>
<div class="block">根据指定的产品信息创建支付信息。</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>product</code> - 产品信息</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>支付信息</dd>
</dl>
</li>
</ul>
<a name="deliverOrder-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deliverOrder</h4>
<pre>java.lang.String&nbsp;deliverOrder(java.lang.String&nbsp;orderID)</pre>
<div class="block">通知游服将指定订单标记为已发货。游服成功处理此请求后将订单标记为"delivered"状态。由于通讯和其他可能出现的问题，"delivered"
 状态并不能成为订单是否已发货的唯一判据，因为很可能应用在解锁产品（道具）后调用getOrderState处理失败。对此应用须做适当处理。</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>orderID</code> - 订单号</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>成功时返回"OK"，失败时返回null。</dd>
</dl>
</li>
</ul>
<a name="getOrder-com.sg.util.UPayParams-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOrder</h4>
<pre><a href="../../../com/sg/util/UOrder.html" title="com.sg.util中的类">UOrder</a>&nbsp;getOrder(<a href="../../../com/sg/util/UPayParams.html" title="com.sg.util中的类">UPayParams</a>&nbsp;data)</pre>
<div class="block">根据支付信息向游服请求生成订单。</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>data</code> - 支付参数</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>成功时返回游服生成的订单，失败时返回null。</dd>
</dl>
</li>
</ul>
<a name="getOrderInfoList-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOrderInfoList</h4>
<pre>java.util.List&lt;<a href="../../../com/sg/util/UOrderInfo.html" title="com.sg.util中的类">UOrderInfo</a>&gt;&nbsp;getOrderInfoList(java.lang.String&nbsp;filter)</pre>
<div class="block">获取用户的订单列表。</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>filter</code> - 过滤字符串</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>订单列表</dd>
</dl>
</li>
</ul>
<a name="getOrderState-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOrderState</h4>
<pre>java.lang.String&nbsp;getOrderState(java.lang.String&nbsp;orderID)</pre>
<div class="block">向游服查询订单的状态。如果SG服务器没有通知过游服订单处理结果，游服需要在订单提交成功后等待一段时间，向SG服务器查询。
 查询时要用到USession.loginExtension。详情见服务器接入文档。</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>orderID</code> - 订单号</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>订单状态。成功时为"generated"、"succeeded"、"delivered"、"failed"和"cheated"之一。失败时为null。
 "generated"表明订单已经生成，但游服还不知道结果。"succeeded"表明订单支付成功。"delivered"表明订单已发货。"failed"表明支付失败。
 "cheated"表明支付金额少于定价。注意这里的状态与UProduct.state不是一回事。</dd>
</dl>
</li>
</ul>
<a name="getProductList-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getProductList</h4>
<pre>java.util.List&lt;<a href="../../../com/sg/util/UProduct.html" title="com.sg.util中的类">UProduct</a>&gt;&nbsp;getProductList(java.lang.String&nbsp;filter)</pre>
<div class="block">获取应用的产品（道具）列表。</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>filter</code> - 过滤字符串</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>成功时返回产品列表，失败时返回null。</dd>
</dl>
</li>
</ul>
<a name="init-com.sg.util.USession-int-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre>void&nbsp;init(<a href="../../../com/sg/util/USession.html" title="com.sg.util中的类">USession</a>&nbsp;session,
          int&nbsp;appID,
          java.lang.String&nbsp;appKey)</pre>
<div class="block">初始化游服。SGAgent调用这个方法来设置登入等操作所需要的参数。</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>session</code> - 经过渠道登入、登入验证以后得到的账户和会话信息</dd>
<dd><code>appID</code> - 应用的ID</dd>
<dd><code>appKey</code> - 应用的密钥</dd>
</dl>
</li>
</ul>
<a name="login--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>login</h4>
<pre><a href="../../../com/sg/util/UAccount.html" title="com.sg.util中的类">UAccount</a>&nbsp;login()</pre>
<div class="block">登入游服。</div>
<dl>
<dt><span class="returnLabel">返回:</span></dt>
<dd>成功时返回游服账户信息，失败时返回null。</dd>
</dl>
</li>
</ul>
<a name="logout-com.sg.util.UAccount-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logout</h4>
<pre>java.lang.String&nbsp;logout(<a href="../../../com/sg/util/UAccount.html" title="com.sg.util中的类">UAccount</a>&nbsp;account)</pre>
<div class="block">登出游服。</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>account</code> - 游服账户信息</dd>
<dt><span class="returnLabel">返回:</span></dt>
<dd>成功时返回"OK"，失败时返回null。</dd>
</dl>
</li>
</ul>
<a name="notifyOrderAccepted-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>notifyOrderAccepted</h4>
<pre>void&nbsp;notifyOrderAccepted(java.lang.String&nbsp;orderID)</pre>
<div class="block">通知游服订单已经被受理。如果支付的UI操作成功，可以调用此方法来通知游服状态的变化。如果游服不支付此功能，可以为空实现。</div>
<dl>
<dt><span class="paramLabel">参数:</span></dt>
<dd><code>orderID</code> - 订单号</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="跳过导航链接">跳过导航链接</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../com/sg/util/package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../index-all.html">索引</a></li>
<li><a href="../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/sg/util/SGAgent.SGClient.html" title="com.sg.util中的接口"><span class="typeNameLink">上一个类</span></a></li>
<li><a href="../../../com/sg/util/UAccount.html" title="com.sg.util中的类"><span class="typeNameLink">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/sg/util/SGGameServerInterface.html" target="_top">框架</a></li>
<li><a href="SGGameServerInterface.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li>构造器&nbsp;|&nbsp;</li>
<li><a href="#method.detail">方法</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
